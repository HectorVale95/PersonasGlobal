<div class="form-container">
  <h2 mat-dialog-title>
    <mat-icon>{{ isEditMode ? 'edit' : 'add' }}</mat-icon>
    {{ isEditMode ? 'Editar' : 'Agregar' }} Persona
  </h2>

  <form [formGroup]="personaForm" (ngSubmit)="onSubmit()">
    <mat-dialog-content>
      <div class="form-fields">
        <!-- Nombres -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Nombres</mat-label>
          <input
            matInput
            formControlName="nombres"
            placeholder="Ingrese los nombres"
            >
          @if (personaForm.get('nombres')?.hasError('required')) {
            <mat-error>
              Los nombres son requeridos
            </mat-error>
          }
          @if (personaForm.get('nombres')?.hasError('minlength')) {
            <mat-error>
              Mínimo 2 caracteres
            </mat-error>
          }
        </mat-form-field>

        <!-- Apellido Paterno -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Apellido Paterno</mat-label>
          <input
            matInput
            formControlName="apellidoPaterno"
            placeholder="Ingrese el apellido paterno"
            >
          @if (personaForm.get('apellidoPaterno')?.hasError('required')) {
            <mat-error>
              El apellido paterno es requerido
            </mat-error>
          }
          @if (personaForm.get('apellidoPaterno')?.hasError('minlength')) {
            <mat-error>
              Mínimo 2 caracteres
            </mat-error>
          }
        </mat-form-field>

        <!-- Apellido Materno -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Apellido Materno</mat-label>
          <input
            matInput
            formControlName="apellidoMaterno"
            placeholder="Ingrese el apellido materno"
            >
          @if (personaForm.get('apellidoMaterno')?.hasError('required')) {
            <mat-error>
              El apellido materno es requerido
            </mat-error>
          }
          @if (personaForm.get('apellidoMaterno')?.hasError('minlength')) {
            <mat-error>
              Mínimo 2 caracteres
            </mat-error>
          }
        </mat-form-field>

        <!-- Dirección -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Dirección</mat-label>
          <textarea
            matInput
            formControlName="direccion"
            placeholder="Ingrese la dirección completa"
            rows="3"
          ></textarea>
          @if (personaForm.get('direccion')?.hasError('required')) {
            <mat-error>
              La dirección es requerida
            </mat-error>
          }
          @if (personaForm.get('direccion')?.hasError('minlength')) {
            <mat-error>
              Mínimo 5 caracteres
            </mat-error>
          }
        </mat-form-field>

        <!-- Teléfono -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Teléfono</mat-label>
          <input
            matInput
            formControlName="telefono"
            placeholder="Ingrese el número de teléfono (10 dígitos)"
            type="tel"
            maxlength="10"
            pattern="[0-9]*"
            >
          @if (personaForm.get('telefono')?.hasError('required')) {
            <mat-error>
              El teléfono es requerido
            </mat-error>
          }
          @if (personaForm.get('telefono')?.hasError('minlength')) {
            <mat-error>
              El teléfono debe tener al menos 10 dígitos
            </mat-error>
          }
          @if (personaForm.get('telefono')?.hasError('maxlength')) {
            <mat-error>
              El teléfono no puede exceder 10 dígitos
            </mat-error>
          }
          @if (personaForm.get('telefono')?.hasError('pattern')) {
            <mat-error>
              El teléfono debe tener exactamente 10 dígitos
            </mat-error>
          }
        </mat-form-field>
      </div>
    </mat-dialog-content>

    <mat-dialog-actions align="end">
      <button
        mat-button
        type="button"
        (click)="onCancel()"
        [disabled]="loading"
        >
        Cancelar
      </button>
      <button
        mat-raised-button
        color="primary"
        type="submit"
        [disabled]="personaForm.invalid || loading"
        >
        @if (loading) {
          <mat-spinner diameter="20"></mat-spinner>
        }
        @if (!loading) {
          <span>{{ isEditMode ? 'Actualizar' : 'Guardar' }}</span>
        }
      </button>
    </mat-dialog-actions>
  </form>
</div>
